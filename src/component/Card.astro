---
import { getImageUrl } from '../backendold.mjs';

const { record } = Astro.props;

const title = record?.nomMaison ?? record?.titre ?? 'Offre';
const description = record?.description ?? '';
const price = record?.prix ?? null;
const surface = record?.surface ?? null;
const city = record?.ville ?? '';
const imageUrl = record?.image ? await getImageUrl(record, record.image) : null;
const offerId = record?.id ?? null;
---

<article class="bg-white border border-slate-200 rounded overflow-hidden shadow-sm">
    {imageUrl ? (
        <img src={imageUrl} alt={title} class="w-full h-48 object-cover" loading="lazy" />
    ) : (
        <div class="w-full h-48 bg-slate-100 flex items-center justify-center text-slate-400 text-sm">
            Pas d'image
        </div>
    )}
    <div class="p-4 space-y-2">
        <h3 class="text-lg font-semibold text-slate-900">{title}</h3>
        {description && <p class="text-sm text-slate-600">{description}</p>}
        <div class="flex flex-wrap gap-2 text-sm text-slate-600">
            {price !== null && price !== undefined && (
                <span class="bg-slate-100 px-2 py-1 rounded">€{price}</span>
            )}
            {surface !== null && surface !== undefined && (
                <span class="bg-slate-100 px-2 py-1 rounded">{surface} m²</span>
            )}
            {city && <span class="bg-slate-100 px-2 py-1 rounded">{city}</span>}
        </div>
        {offerId && (
            <a
                href={`/offres/${offerId}`}
                class="inline-flex items-center text-sm font-semibold text-blue-600 hover:text-blue-700"
            >
                Voir plus
            </a>
        )}
    </div>
</article>
